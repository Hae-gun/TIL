# 2020-02-21

<hr>

## Linux day4

### root 암호 복구

<hr>

| 소프트웨어<br />os                | 리눅스                       |
| --------------------------------- | ---------------------------- |
| 커널<br />내장 - 업그레이드 수정. | 제어프로그램 내장.           |
| 하드웨어                          | cpu processor<br />hard disk |

커널 : OS와 하드웨어 사이 제어.

### 네트워크 설정.

<hr>

- 가장 중요한 정보.

* ifdown / ifup

* 또는 systemctl start networ -> 부팅시 자동으로 실행됨.

* 톰켓설정

  * `/usr/local/tomcat9/conf/ : 설정파일.xml`
  * `/usr/local/tomcat9/lib/*.jar : 라이브러리 파일(ex ojdbc6.jar)`
  * `/usr/local/tomcat9/webapps/ : 스프링 mvc 프로젝트 폴더위치.`

* 톰켓구동

  1. 톰캣 시작.

     ```
     /usr/local/tomcat9/bin/startup.sh
     ```
     
2. 리눅스 - localhost - 접속.
  
   * Firefox 에서 http://localhost:8080 or http://192.168.111.100:8080 접속
   
   

  ![image-20200221094844651](2020-02-21_Linux%20d4.assets/image-20200221094844651.png)

3. 호스트os(windows)에서 접속.
  
     * Linux의 방화벽떄문에 윈도우에서 접속이 안됨.
     
       ![image-20200221095035610](2020-02-21_Linux%20d4.assets/image-20200221095035610.png)
  
  4. 톰캣(`톰켓포트:8080`) & 오라클(`db서버:1521 `+ `웹서버:8080` 동시 자동 설치됨) 사용시 포트충돌. 포트번호 바꿔주기.
  
     * 포트변경.
     
       ![image-20200221095229363](2020-02-21_Linux%20d4.assets/image-20200221095229363.png)
     
     * 이부분을 변경
     
       ![image-20200221095256414](2020-02-21_Linux%20d4.assets/image-20200221095256414.png)
     
     * 9090으로 변경. (윈도우에서도 동일하게 가능함.)
     
     * 서버 종료후 다시 실행
     
       ![image-20200221095443932](2020-02-21_Linux%20d4.assets/image-20200221095443932.png)
     
     * 변경확인
     
     

  ![image-20200221095558915](2020-02-21_Linux%20d4.assets/image-20200221095558915.png)

  5. 방화벽 기본설정.
  
     * 모두 해제해도 되지만 보안상위험함
     
     * 특정 포트만 방화벽을 해제하도록 설정예정.
     
     * 방화벽 서비스 : `firewalld`
     
       ![image-20200221095726285](2020-02-21_Linux%20d4.assets/image-20200221095726285.png)
     
     * 9090 포트만 방화벽 해제하기
     
       * firewall의 설정을 바꿔주는 명령어
       
         * `firewall-config`
       
           ![image-20200221095849897](2020-02-21_Linux%20d4.assets/image-20200221095849897.png)
       
         * 설정영구적으로 변경
       
         * ![image-20200221095913323](2020-02-21_Linux%20d4.assets/image-20200221095913323.png)
       
         * 포트에 추가
       
           ![image-20200221095944366](2020-02-21_Linux%20d4.assets/image-20200221095944366.png)
       
         * firewall restart 기능
       
           ![image-20200221100021743](2020-02-21_Linux%20d4.assets/image-20200221100021743.png)
       
           
       
         * `firewall-cmd`
  
  6. 톰캣 종료.

  

  

  * 보통의 구조
    * 개발 : windows
      1. dynamic web project (servlet + jsp)
      2. spring mvc project
    * 서버운영 : linux - deployee 방식.

  

  ### 리눅스로 Deployee 하기

  * 보통 윈도우에서는 이클립스로 프로젝트를 진행.
    * 위와 같은 경우는 이클립스에 톰캣을 내장시켜 진행하는 것과 같은 의미.
  * 톰캣을 이용해서도 작성이 가능함.(톰켓에 메모장을 이용하여.)
  * 리눅스 에서는 윈도우와 폴더구조가 다름.
  * 이클립스로 자동으로 맞추게 만듬.
    * tomcat9 구조 맞추어서 압축이 되도록.

  

  * 윈도우 에서는.	
  
    1. 윈도우에서 Dynamic web project 하나 생성.
    
    2. jsp 파일 하나 생성.
    
    3. export를 통해 vm 프로젝트를 war파일로 만듬.
    
       ![image-20200221102702824](2020-02-21_Linux%20d4.assets/image-20200221102702824.png)
    
    4. vmware로 이동
    
       ![image-20200221102721939](2020-02-21_Linux%20d4.assets/image-20200221102721939.png)
    
    5. `/usr/local/tomcat9/webapps` 로 war파일을 이동
    
       * 톰켓이 켜있으면 자동으로 압축이 해제됨.
    
    6. 윈도우 에서 192.168.111.100/webapps/*.jsp로 들어오면 접속이 가능하다.
    
    7. `!! 스프링의 경우 Context는 war 압축파일에서 .war 파일을 지운 이름이 Context이름으로 지정된다.`
  
  * 리눅스 에서는..
    
    * 컨텍스트 명은 war압축파일에서 .war를 제거한 파일명이 컨텍스트명으로 지정된다.

### Oracle DB 다운로드 및 설치

  ![image-20200221130820891](2020-02-21_Linux%20d4.assets/image-20200221130820891.png)

  

  ![image-20200221130810090](2020-02-21_Linux%20d4.assets/image-20200221130810090.png)

  

  ![image-20200221130902084](2020-02-21_Linux%20d4.assets/image-20200221130902084.png)

  ![image-20200221130925212](2020-02-21_Linux%20d4.assets/image-20200221130925212.png)

  * 다운로드 후 ZIP 파일 압축해제.

  ![image-20200221131615983](2020-02-21_Linux%20d4.assets/image-20200221131615983.png)

> 경로도 지정해야 됨!!

* rpm 명령어로 실행.
* qip는 설치정보 확인

![image-20200221131744436](2020-02-21_Linux%20d4.assets/image-20200221131744436.png)

* 설치는 yum으로 진행.

* 설치전.. 메모리를 늘려야함.

  * 리눅스 설치시 `/ : 나머지용량` 와 `swap : 2GB` 두개의 파티션으로 나눴었음.

  * `swap` 은 임시메모리 개념으로 만든것.

  * 오라클을 `swap`에 저장할 예정인데 2gb로는 부족하여 임시적으로 늘려야함. (설치시에만 늘림)

  * free 명령어

    ![image-20200221132117874](2020-02-21_Linux%20d4.assets/image-20200221132117874.png)

    * 현재 1982mb정도 공간이있음.

  * swapon -s

    ![image-20200221132220726](2020-02-21_Linux%20d4.assets/image-20200221132220726.png)

    * swapon 을 통해 사이즈 확인.

  * 아래 명령어를 통해 용량 임시 증가.

    ![image-20200221132511227](2020-02-21_Linux%20d4.assets/image-20200221132511227.png)

  * 아래 명령어도 입력

    ![image-20200221132950475](2020-02-21_Linux%20d4.assets/image-20200221132950475.png)

  * 다시 확인

    ![image-20200221133031085](2020-02-21_Linux%20d4.assets/image-20200221133031085.png)

  * yum을 이용하여 설치진행.

    ![image-20200221133332107](2020-02-21_Linux%20d4.assets/image-20200221133332107.png)

  * 설치 완료!

    ![image-20200221133444662](2020-02-21_Linux%20d4.assets/image-20200221133444662.png)
    
  * 파이프 연산자를 통해 확인
  
    ![image-20200221133649068](2020-02-21_Linux%20d4.assets/image-20200221133649068.png)
  
  * 설치후 설정이 필요하다.
  
    * 환경설정 명령어
  
      ![image-20200221133801400](2020-02-21_Linux%20d4.assets/image-20200221133801400.png)
  
    * 포트번호 지정 (그냥엔터)
  
      ![image-20200221133853986](2020-02-21_Linux%20d4.assets/image-20200221133853986.png)
  
    * db포트
  
      ![image-20200221133925201](2020-02-21_Linux%20d4.assets/image-20200221133925201.png)
  
    * system 암호지정(암호 안보임)
  
      ![image-20200221133945387](2020-02-21_Linux%20d4.assets/image-20200221133945387.png)
  
    * 부트시 재가동 지정 (y입력)
  
      ![image-20200221134006884](2020-02-21_Linux%20d4.assets/image-20200221134006884.png)
  
    * 설정완료
  
      ![image-20200221134128272](2020-02-21_Linux%20d4.assets/image-20200221134128272.png)
  
    * 설치후에 컴퓨터를 껐다 키거나 아래 키워드로 오라클 가동.
  
      ![image-20200221134257736](2020-02-21_Linux%20d4.assets/image-20200221134257736.png)
  
      * stop으로 멈춤 가능 status 로 상태 확인 가능.
  
    * 오라클 경로
  
      ![image-20200221134555820](2020-02-21_Linux%20d4.assets/image-20200221134555820.png)
  
    * oracle_env.sh 실행
  
      ![image-20200221134710802](2020-02-21_Linux%20d4.assets/image-20200221134710802.png)
  
      * 오류 없으면 올바르게 실행된것.
  
      * oracle_env..sh -> path 경로 지정해준것.
  
        ![image-20200221134801537](2020-02-21_Linux%20d4.assets/image-20200221134801537.png)
  
    * gedit으로 bashrc 실행
  
      ![image-20200221135140646](2020-02-21_Linux%20d4.assets/image-20200221135140646.png)
  
    * gedit에서 아래 추가
  
      ![image-20200221135123846](2020-02-21_Linux%20d4.assets/image-20200221135123846.png)
  
      * 리부팅 마다 위에 `oracle_env.sh` 명령어를 실행함.
  
    * firewall-config에서 방화벽 해제
  
      ![image-20200221135440607](2020-02-21_Linux%20d4.assets/image-20200221135440607.png)
  
    * 윈도우에서 포트 열렸나 확인.
  
      ![image-20200221135558312](2020-02-21_Linux%20d4.assets/image-20200221135558312.png)
  
    * 접속
  
      ![image-20200221135654781](2020-02-21_Linux%20d4.assets/image-20200221135654781.png)
  
    * hr계정 접속 부여
  
      ![image-20200221140117386](2020-02-21_Linux%20d4.assets/image-20200221140117386.png)
  
    * scott 계정 생성
  
      ![image-20200221140507934](2020-02-21_Linux%20d4.assets/image-20200221140507934.png)
  
    * 권한 부여 & 접속
  
      ![image-20200221140544309](2020-02-21_Linux%20d4.assets/image-20200221140544309.png)




### 리눅스 윈도우 서로 접속해보기.

1. 리눅스에서 윈도우 db로 접속하기.

   * 리눅스에서.

     ![image-20200221143526134](2020-02-21_Linux%20d4.assets/image-20200221143526134.png)

   * 설정정보

     ![image-20200221143541584](2020-02-21_Linux%20d4.assets/image-20200221143541584.png)

   * 3~10 라인 코드에 의해서 linux에서 db접속시 리눅스의 db로 접속하게 되는것.

   * 아랫라인에 추가

     ![image-20200221143954137](2020-02-21_Linux%20d4.assets/image-20200221143954137.png)

     * 192.168.111.1 은 vmnet8 ip정보

   * 작성후 sqlplus에서 윈도우 db에 접속

     ![image-20200221144312159](2020-02-21_Linux%20d4.assets/image-20200221144312159.png)

     * @win을 작성하면 아까 작성한 host ip 정보의 db로 접속하게 된다.